# Настройки автоответа в чате

Эти настройки размещаются в разделе `contact_dialog` и применяются если в настройках чата установлено [время через которое](./chat-settings.md#no-answer-limit) появляется автоматический диалог получения контактов пользователя.

## Все настройки диалога по умолчанию

Эти параметры будут применены если в настройках нет раздела `contact_dialog` 

```json
{
  "contact_dialog": {
    "response_number": "",
    "response_email": "",
    "contact_types": [
      { "name": "phone",    "text": "Телефон",   "on_select_text": "Введите Ваш номер телефона",     "on_end_text": "Вам поступит звонок с номера {{PHONE}}" },
      { "name": "whatsapp", "text": "WhatsApp",  "on_select_text": "Введите Ваш номер WhatsApp",     "on_end_text": "Вам поступит звонок с номера {{PHONE}}" },
      { "name": "telegram", "text": "Telegram",  "on_select_text": "Введите Ваш номер Телеграм",     "on_end_text": "Вам поступит звонок с номера {{PHONE}}" },
      { "name": "viber",    "text": "Viber",     "on_select_text": "Введите Ваш номер Вайбер",       "on_end_text": "Вам поступит звонок с номера {{PHONE}}" },
      { "name": "email",    "text": "Эл. почта", "on_select_text": "Введите Вашу электронную почту", "on_end_text": "Вам будет отправлено электронное письмо с адреса {{EMAIL}}" }
    ],
    "steps": [
      { "text": "На данный момент все операторы заняты, выберите как мы можем с Вами связаться", "wait_input": true, "wait_time": 0, "info": "Выберите как с Вами связаться" },
      { "text": "{{on_select_text}}", "wait_input": true, "wait_time": 500, "info": "{{on_select_text}}" },
      { "text": "Как к Вам обращаться?", "wait_input": true, "wait_time": 500, "info": "Напишите Ваше имя" },
      { "text": "{{on_end_text}}", "wait_input": false, "wait_time": 500, "info": null }
    ]
  }
}
```

## response_number

Номер телефона, который будет вставлен вместо <span>{</span><span>{</span>PHONE<span>}}</span> в любом месте текста указанного в `on_end_text`

## response_email

Адрес эл. почты, который будет вставлен вместо <span>{</span><span>{</span>EMAIL<span>}}</span> в любом месте текста указанного в `on_end_text`

## contact_types

Список предложенных типов контактов на первом шаге диалога "...выберите как мы можем с Вами связаться" и настройки связанные с каждым из этих типов.    
В списке можно убирать или добавлять типы контактов.

Пример: Предлагать пользователю выбрать из двух вариантов телефон и Телеграм

```json
{
  "contact_dialog": {
    "contact_types": [
      { "name": "phone",    "text": "Телефон",   "on_select_text": "Введите Ваш номер телефона", "on_end_text": "Вам поступит звонок с номера {{PHONE}}" },
      { "name": "telegram", "text": "Telegram",  "on_select_text": "Введите Ваш номер Телеграм", "on_end_text": "Мы напишем Вам в Телеграм с номера {{PHONE}}" }
    ]    
  }
}

```

Каждый элемент в этом списке содержит дополнительные настройки:

`name` - Обозначение типа контакта, используется на сервере. Возможные обозначения: `telegram`, `whatsapp`, `vk`, `ok`, `skype`, `viber`, `email`, `fax`, `icq`  
`text` - Текст, который будет показан пользователю для выбора.  
`on_select_text` - Текст, который будет показан пользователю после того как он выбрал этот способ связи.    
`on_end_text` - Текст, который будет показан пользователю в конце всего диалога если был выбран этот тип контактов.

## steps

Список шагов которые выполняются последовательно после начала диалога.  
В списке заложено четыре шага их нельзя удалять или добавлять, но можно менять некоторые параметры.  
Если меняются параметры не у всех элементов, все-равно нужно оставлять все шаги в списке.

```json
{
  "contact_dialog": {
    "steps": [
      { "text": "На данный момент все операторы заняты, выберите как мы можем с Вами связаться", "wait_input": true, "wait_time": 0, "info": "Выберите как с Вами связаться" },
      { "text": "{{on_select_text}}", "wait_input": true, "wait_time": 500, "info": "{{on_select_text}}" },
      { "text": "Как к Вам обращаться?", "wait_input": true, "wait_time": 500, "info": "Напишите Ваше имя" },
      { "text": "{{on_end_text}}", "wait_input": false, "wait_time": 500, "info": null }
    ]
  }
}
```

`text` - Текст, который будет показан пользователю на данном шаге.     
`wait_input` - Определяет надо-ли ждать ответ пользователя прежде чем переходить к следующему шагу.      
`wait_time` - Определяет с какой задержкой будет показано сообщение следующего шага.      
`info` - Текст, который будет показан в поле для ввода сообщения до того как пользователь начнёт печатать.


Вместо текста в поле `text` и `info` можно использовать специальный шаблон <span>{</span><span>{</span>on_select_text<span>}}</span> или <span>{</span><span>{</span>on_end_text<span>}}</span>, которые будут заменены текстом из настроек `contact_types` полей `on_select_text` и `on_end_text` выбранного пользователем способа связи.







